---
layout: null
---

<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>🌸 桜Index - 公式サイト</title>
  <style>
    body{margin:0;background:#0b1220;color:#e2e8f0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji"}
    .wrap{max-width:1180px;margin:32px auto;padding:0 16px}
    .site-head{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:14px}
    .site-title{font-size:22px;font-weight:800}
    .btn{display:inline-block;padding:10px 14px;border-radius:10px;border:1px solid #334155;background:#0f172a;color:#e2e8f0;text-decoration:none}
    .index-grid{display:grid;grid-template-columns:1fr;gap:18px}
    @media(min-width:980px){.index-grid{grid-template-columns:1fr 1fr}}
  </style>
</head>
<body>
<header class="site-head">
  <div class="site-title">🌸 桜Index - 公式サイト</div>
  <div class="top-actions" style="display:flex;gap:10px">
    <a class="btn" href="https://x.com/your_account" target="_blank" rel="noopener">公式X（Twitter）</a>
    <a class="btn" href="https://note.com/your_account" target="_blank" rel="noopener">公式note</a>
  </div>
</header>

<main class="wrap">
  <div class="index-grid">
    {% include components/index-card.html
       id="ASTRA4"
       title="Astra4" flag="🇯🇵" badge="宇宙ベンチャー"
       desc="宇宙関連銘柄の等ウェイト指数。日中は騰落率、長期はレベル推移を表示。" %}

    {% include components/index-card.html
       id="R-BANK9"
       title="R-BANK9" flag="🇯🇵" badge="地方銀行"
       desc="地方銀行9銘柄の等ウェイト指数。日中は騰落率、長期はレベル推移を表示。" %}

    {% include components/index-card.html
       id="AIN-10"
       title="AIN-10" flag="🇺🇸" badge="AI関連10"
       desc="米AI関連10銘柄の等ウェイト指数。短期モメンタム観測に便利。" %}

    {% include components/index-card.html
       id="S-COIN+"
       title="S-COIN+" flag="🇯🇵" badge="仮想資産関連"
       desc="暗号資産関連の等ウェイト指数。日中は騰落率、長期はレベル推移を表示。" %}
  </div>

  <p style="color:#94a3b8;text-align:center;margin:26px 0 8px;">
    データ：各指数は等加重指数（仕様は各リポジトリ参照）／ 画像は各指数リポの自動生成スナップショットと同期しています。<br>
    ※本サイトは投資助言ではありません。投資判断はご自身の責任（自己責任）でお願いいたします。<br>
    © {{ 'now' | date: '%Y' }} 桜Index
  </p>
</main>

<script>
/* ========= 強化ポイント =========
 * 1) 同一オリジン（このサイト内）の /charts /docs/charts を探索
 * 2) さらに、指数ごとに別リポ/別Pagesの「外部オリジン」を設定できるように
 * 3) IDの表記ゆれ（S-COIN+ など）に対して、フォルダ名の候補を自動生成
 * 4) Console に詳細ログ（OK/404）を出力
 */

/*** ▼▼ ここに “別リポ/別ドメイン（外部オリジン）” を必要に応じて設定してください ▼▼
 *  例:
 *   'ASTRA4' : 'https://sakuraiindex.github.io/ASTRA4',
 *   'R-BANK9': 'https://sakuraiindex.github.io/R-BANK9',
 *   'AIN-10' : 'https://sakuraiindex.github.io/AIN-10',
 *   'S-COIN+': 'https://sakuraiindex.github.io/S-COIN-PLUS'
 * 空のままでもOK（同一オリジンのみ探索）
 */
const EXTERNAL_ORIGINS = {
  // 'ASTRA4' : 'https://<your-org>.github.io/<Astra4-repo>',
  // 'R-BANK9': 'https://<your-org>.github.io/<R-BANK9-repo>',
  // 'AIN-10' : 'https://<your-org>.github.io/<AIN-10-repo>',
  // 'S-COIN+': 'https://<your-org>.github.io/<S-COIN-PLUS-repo>',
};
/*** ▲▲ ここまで ▲▲ */

(function(){
  const base = "{{ site.baseurl | default: '' }}";
  const withBase = p => (base ? base + (p.startsWith('/')? p : '/'+p) : (p.startsWith('/')? p : '/'+p));
  const uniq = arr => [...new Set(arr)];

  // ID からフォルダ候補（IDの表記ゆれ）を作る
  function folderCandidates(id){
    const raw = id;
    const enc = encodeURIComponent(id);     // 例: 'S-COIN+' -> 'S-COIN%2B'
    const minus = id.replace(/\+/g,'-');    // 例: 'S-COIN-'
    const plusW = id.replace(/\+/g,'PLUS'); // 例: 'S-COINPLUS'
    const under = id.replace(/\+/g,'_');    // 例: 'S-COIN_'
    return uniq([raw, enc, minus, plusW, under]);
  }

  // 画像/JSON ファイル名
  const FILES_IMG = ['intraday_am.png','intraday.png'];
  const FILES_JSON = ['stats.json'];

  function buildCandidatesFor(id, files, origins){
    const folders = folderCandidates(id);
    const list = [];

    // 1) 同一オリジン（このサイト内ルート & baseurl）
    for(const f of files){
      for(const fd of folders){
        list.push(`charts/${fd}/${f}`, `docs/charts/${fd}/${f}`);
        list.push(withBase(`charts/${fd}/${f}`), withBase(`docs/charts/${fd}/${f}`));
      }
    }

    // 2) 外部オリジン（必要に応じて設定）
    const ext = origins[id];
    if(ext){
      for(const f of files){
        for(const fd of folders){
          list.push(`${ext.replace(/\/$/,'')}/charts/${fd}/${f}`);
          list.push(`${ext.replace(/\/$/,'')}/docs/charts/${fd}/${f}`);
        }
      }
    }
    return uniq(list);
  }

  function tryLoadImage(card, id){
    const img = card.querySelector('.chart-img');
    const fb  = card.querySelector('.img-fallback');
    const paths = buildCandidatesFor(id, FILES_IMG, EXTERNAL_ORIGINS);
    let i = 0;
    function next(){
      if(i >= paths.length){ img.style.display='none'; fb.style.display='block'; return; }
      const url = paths[i++];
      const probe = new Image();
      probe.onload = ()=>{ img.src = url; img.style.display='block'; fb.style.display='none'; console.log(`[chart OK] ${id} -> ${url}`); };
      probe.onerror= ()=>{ console.log(`[chart 404] ${id} × ${url}`); next(); };
      // キャッシュバスター
      probe.src = url + (url.includes('?') ? `&v=${Date.now()}` : `?v=${Date.now()}`);
    }
    console.log(`[chart try] ${id}`, paths);
    next();
  }

  function tryLoadStats(card, id){
    const pct = card.querySelector('.idx-pct');
    const paths = buildCandidatesFor(id, FILES_JSON, EXTERNAL_ORIGINS);
    const keys  = ['pct_intraday','pct','intraday_pct','am_pct','delta','delta_level','change'];

    function asPct(v){
      if(v===null || v===undefined || v==='') return null;
      let x = typeof v==='string' ? parseFloat(v) : v;
      if(!isFinite(x)) return null;
      if(Math.abs(x) > 1.0) x = x/100.0; // 123 -> 1.23%
      const p = x*100.0;
      const text = (p>0?'+':'') + p.toFixed(2) + '%';
      const cls  = (p>0?'up':(p<0?'down':'na'));
      return { text, cls };
    }

    let i = 0;
    function next(){
      if(i >= paths.length){ pct.textContent='N/A'; pct.className='idx-pct na'; pct.style.color='#94a3b8'; return; }
      const url = paths[i++];
      fetch(url, {cache:'no-cache'})
        .then(r=>{ if(!r.ok) throw 0; return r.json(); })
        .then(j=>{
          console.log(`[stats OK] ${id} -> ${url}`, j);
          let v=null; for(const k of keys){ if(j && j[k]!==undefined){ v=j[k]; break; } }
          const res = asPct(v);
          if(!res) throw 0;
          pct.textContent = res.text;
          pct.className = 'idx-pct '+res.cls;
          pct.style.color = (res.cls==='up') ? '#22c55e' : (res.cls==='down' ? '#ef4444' : '#94a3b8');
        })
        .catch(()=>{ console.log(`[stats 404] ${id} × ${url}`); next(); });
    }
    console.log(`[stats try] ${id}`, paths);
    next();
  }

  document.addEventListener('DOMContentLoaded', ()=>{
    document.querySelectorAll('.idx-card').forEach(card=>{
      const id = card.dataset.id;
      tryLoadImage(card, id);
      tryLoadStats(card, id);
    });
  });
})();
</script>
</body>
</html>
