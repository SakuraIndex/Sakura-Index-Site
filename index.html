<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ğŸŒ¸ æ¡œIndex - å…¬å¼ã‚µã‚¤ãƒˆ</title>
  <link rel="icon" href="https://emojiapi.dev/api/v1/cherry-blossom.svg">
  <style>
    :root{
      --bg:#0d0d0f;
      --card:#1a1a1f;
      --panel:#0f0f12;
      --fg:#ddd;
      --sub:#aaa;
      --accent:#fff;
      --pos:#28e07c;
      --neg:#ff4d4d;
      --shadow:0 0 12px rgba(255,255,255,0.05);
      --radius:16px;
      --gap:22px;
      --maxw:1500px; /* å…¨ä½“ã®æœ€å¤§å¹…ï¼ˆ2Ã—2ãŒç¶ºéº—ã«åã¾ã‚‹å¹…ï¼‰ */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; padding:0;
      background:var(--bg); color:var(--fg);
      font-family:system-ui,-apple-system,'Inter','Noto Sans JP',sans-serif;
    }
    header{
      text-align:center; padding:22px 16px 12px;
    }
    h1{margin:0; font-size:28px}
    .info{color:var(--sub); font-size:14px; margin:8px 0 14px}
    .links{display:flex; justify-content:center; gap:10px; margin-bottom:10px}
    .links a{
      background:#333; color:#fff; text-decoration:none;
      padding:8px 14px; border-radius:8px; font-size:14px;
      transition:background .2s;
    }
    .links a:hover{background:#555}

    /* ====== ã‚°ãƒªãƒƒãƒ‰ ====== */
    .wrap{
      max-width:var(--maxw);
      margin:0 auto;
      padding:0 20px 34px;
    }
    .grid{
      display:grid;
      gap:var(--gap);
      align-content:stretch;
      /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯1ã‚«ãƒ©ãƒ ï¼ˆãƒ¢ãƒã‚¤ãƒ«ï¼‰ */
      grid-template-columns: 1fr;
    }
    /* ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆï½å°ã•ã‚PCï¼š2ã‚«ãƒ©ãƒ ï¼ˆ2Ã—2ã§åŸ‹ã¾ã‚‹ï¼‰ */
    @media (min-width: 900px){
      .grid{ grid-template-columns: repeat(2, 1fr); }
    }

    .card{
      background:var(--card);
      box-shadow:var(--shadow);
      border-radius:var(--radius);
      padding:16px;
      display:flex;
      flex-direction:column;
      height:100%;
      min-height: 340px; /* è¦‹ã‚„ã™ã•ç”¨ï¼šæƒã† */
    }
    .card-header{
      display:flex; justify-content:space-between; align-items:center;
      margin-bottom:10px;
    }
    .title{display:flex; align-items:center; gap:8px; font-weight:700}
    .category{
      font-size:12px; background:#333; color:#ccc;
      padding:2px 6px; border-radius:6px;
    }
    .percent{font-weight:700}
    .percent.positive{color:var(--pos)}
    .percent.negative{color:var(--neg)}

    .chart{
      background:var(--panel);
      border-radius:12px;
      width:100%;
      flex:1; /* ä½™ç™½ã‚’å‡ç­‰ã«æŠ¼ã—åºƒã’ã¦é«˜ã•ã‚’æƒãˆã‚‹ */
      display:flex; align-items:center; justify-content:center;
      overflow:hidden;
    }
    .chart img{
      width:100%;
      height:auto;
      border-radius:12px;
      /* å„PNGã®ç¸¦æ¨ªãŒé•ã£ã¦ã‚‚é«˜ã•æ„Ÿã‚’æƒãˆã‚‹ */
      aspect-ratio: 16 / 9;
      object-fit: contain;
    }

    footer{
      text-align:center; font-size:12px; color:#888;
      margin-top: 18px; padding-bottom: 22px;
    }
  </style>
</head>
<body>
  <header>
    <h1>ğŸŒ¸ æ¡œIndex - å…¬å¼ã‚µã‚¤ãƒˆ</h1>
    <div class="info" id="sync-info">åŒæœŸå®Œäº†: ãƒ­ãƒ¼ãƒ‰ä¸­...</div>
    <div class="links">
      <a href="https://x.com/SakuraIndex" target="_blank" rel="noopener">å…¬å¼Xï¼ˆTwitterï¼‰</a>
      <a href="https://note.com/sakuraindex" target="_blank" rel="noopener">å…¬å¼note</a>
    </div>
  </header>

  <div class="wrap">
    <main class="grid" id="charts"></main>
  </div>

  <footer>
    ãƒ‡ãƒ¼ã‚¿ï¼šç­‰åŠ é‡æŒ‡æ•°ï¼ˆä»•æ§˜ã¯å„ãƒªãƒã‚¸ãƒˆãƒªå‚ç…§ï¼‰ / ç”»åƒã¯å„æŒ‡æ•°ãƒªãƒã®è‡ªå‹•ç”Ÿæˆã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’åŒæœŸã—ã¦ã„ã¾ã™ã€‚<br>
    â€»æœ¬ã‚µã‚¤ãƒˆã¯æŠ•è³‡åŠ©è¨€ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚æŠ•è³‡åˆ¤æ–­ã¯ã”è‡ªèº«ã®è²¬ä»»ï¼ˆè‡ªå·±è²¬ä»»ï¼‰ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚<br>
    Â© 2025 æ¡œIndex
  </footer>

  <script>
    const charts = [
      { id: 'astra4',     name: 'Astra4',  category: 'å®‡å®™ãƒ™ãƒ³ãƒãƒ£ãƒ¼', flag: 'ğŸ‡¯ğŸ‡µ' },
      { id: 'scoin_plus', name: 'S-COIN+', category: 'ä»®æƒ³é€šè²¨é–¢é€£',   flag: 'ğŸ’±' },
      { id: 'rbank9',     name: 'R-BANK9', category: 'åœ°æ–¹éŠ€è¡Œ',       flag: 'ğŸ‡¯ğŸ‡µ' },
      { id: 'ain10',      name: 'AIN-10',  category: 'AIé–¢é€£10',       flag: 'ğŸ‡ºğŸ‡¸' },
    ];

    async function loadData() {
      const container = document.getElementById("charts");
      const syncInfo = document.getElementById("sync-info");
      const time = new Date().toLocaleString("ja-JP", { timeZone: "Asia/Tokyo" });
      syncInfo.textContent = `åŒæœŸå®Œäº†: ${time} / ãƒ‡ãƒ¼ã‚¿: docs/charts/*`;

      for (const chart of charts) {
        const base = `docs/charts/${chart.id}`;
        const statsPath = `${base}_stats.json`;
        const imgPath   = `${base}_1d.png`;

        let percent = "N/A", colorClass = "";

        try {
          const res = await fetch(statsPath, { cache: "no-cache" });
          if (res.ok) {
            const data = await res.json();
            // ã‚¹ã‚­ãƒ¼ãƒï¼š{ pct_1d: number, scale: "pct" | "price" ... }
            // æ—§ã‚­ãƒ¼(change_percent)ã«ã‚‚ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
            const v = (typeof data.pct_1d === "number")
                      ? data.pct_1d
                      : (typeof data.change_percent === "number" ? data.change_percent : null);
            if (v !== null) {
              percent = `${v.toFixed(2)}%`;
              colorClass = v >= 0 ? "positive" : "negative";
            }
          }
        } catch (_) {}

        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <div class="card-header">
            <div class="title">${chart.flag} ${chart.name} <span class="category">${chart.category}</span></div>
            <div class="percent ${colorClass}">${percent}</div>
          </div>
          <div class="chart"><img src="${imgPath}" alt="${chart.name} chart"></div>
        `;
        container.appendChild(card);
      }
    }

    loadData();
  </script>
</body>
</html>
